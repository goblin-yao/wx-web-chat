(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{8584:function(e,t,n){"use strict";var o,r,a,s,i=n(6254);function l(){return(l=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}t.Z=function(e){return i.createElement("svg",l({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:30,height:30,fill:"none"},e),o||(o=i.createElement("defs",null,i.createElement("path",{id:"bot_svg__a",d:"M0 0h30v30H0z"}),i.createElement("path",{id:"bot_svg__c",d:"M0 0h20.455v20.455H0z"}))),i.createElement("g",null,r||(r=i.createElement("rect",{fill:"#E7F8FF",width:30,height:30,rx:10})),a||(a=i.createElement("mask",{id:"bot_svg__b",fill:"#fff"},i.createElement("use",{xlinkHref:"#bot_svg__a"}))),i.createElement("g",{mask:"url(#bot_svg__b)"},i.createElement("g",{transform:"translate(4.773 4.773)"},s||(s=i.createElement("mask",{id:"bot_svg__d",fill:"#fff"},i.createElement("use",{xlinkHref:"#bot_svg__c"}))),i.createElement("g",{mask:"url(#bot_svg__d)"},i.createElement("path",{fillRule:"evenodd",style:{fill:"#1f948c"},d:"M19.11 8.37c.17-.52.26-1.06.26-1.61 0-.9-.24-1.79-.71-2.57a5.24 5.24 0 0 0-4.53-2.59c-.37 0-.73.04-1.09.11A5.201 5.201 0 0 0 9.17 0h-.04C6.86 0 4.86 1.44 4.16 3.57A5.11 5.11 0 0 0 .71 6.04C.24 6.83 0 7.72 0 8.63c0 1.27.48 2.51 1.35 3.45-.18.52-.27 1.07-.27 1.61 0 .91.25 1.8.71 2.58 1.13 1.94 3.41 2.94 5.63 2.47a5.18 5.18 0 0 0 3.86 1.71h.05c2.26 0 4.27-1.44 4.97-3.57a5.132 5.132 0 0 0 3.45-2.47c.46-.78.7-1.67.7-2.58 0-1.28-.48-2.51-1.34-3.46ZM8.947 18.158c-.04.03-.08.05-.12.07.7.58 1.57.89 2.48.89h.01c2.14 0 3.88-1.72 3.88-3.83v-4.76c0-.02-.02-.04-.04-.05l-1.74-.99v5.75c0 .23-.13.45-.34.57l-4.13 2.35Zm-.67-1.153 4.17-2.38c.02-.01.03-.03.03-.05v-1.99l-5.04 2.87c-.21.12-.47.12-.68 0l-4.13-2.35c-.04-.02-.09-.06-.12-.07-.04.21-.06.43-.06.65 0 .67.18 1.33.52 1.92v-.01c.7 1.19 1.98 1.92 3.37 1.92.68 0 1.35-.18 1.94-.51ZM3.903 5.168v-.14c-.85.31-1.57.9-2.02 1.68a3.78 3.78 0 0 0-.52 1.91c0 1.37.74 2.64 1.94 3.33l4.17 2.37c.02.01.04.01.06 0l1.75-1-5.04-2.87a.64.64 0 0 1-.34-.57v-4.71Zm13.253 3.337-4.18-2.38c-.02 0-.04 0-.06.01l-1.74.99 5.04 2.87c.21.12.34.34.34.58v4.85c1.52-.56 2.54-1.99 2.54-3.6 0-1.37-.74-2.63-1.94-3.32ZM8.014 5.83c-.02.01-.03.03-.03.05v1.99L13.024 5a.692.692 0 0 1 .68 0l4.13 2.35c.04.02.08.05.12.07.03-.21.05-.43.05-.65 0-2.11-1.74-3.83-3.88-3.83-.68 0-1.35.18-1.94.51l-4.17 2.38Zm1.133-4.492c-2.15 0-3.89 1.72-3.89 3.83v4.76c0 .02.02.03.03.04l1.75 1v-5.75c0-.23.13-.45.34-.57l4.13-2.35c.04-.03.09-.06.12-.07-.7-.58-1.58-.89-2.48-.89ZM7.983 11.51l2.24 1.27 2.25-1.27V8.95l-2.25-1.28-2.24 1.28v2.56Z"}))))))}},5520:function(e,t,n){"use strict";var o,r,a=n(6254);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}t.Z=function(e){return a.createElement("svg",s({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),o||(o=a.createElement("defs",null,a.createElement("path",{id:"close_svg__a",d:"M0 0h16v16H0z"}))),a.createElement("g",null,r||(r=a.createElement("mask",{id:"close_svg__b",fill:"#fff"},a.createElement("use",{xlinkHref:"#close_svg__a"}))),a.createElement("g",{mask:"url(#close_svg__b)"},a.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2.667 2.667)",d:"m0 0 10.67 10.67M0 10.67 10.67 0"}))))}},359:function(e,t,n){"use strict";var o,r,a,s=n(6254);function i(){return(i=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}t.Z=function(e){return s.createElement("svg",i({width:30,height:14,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:"#fff"},e),o||(o=s.createElement("circle",{cx:15,cy:15,r:15,fill:"var(--primary, red)"},s.createElement("animate",{attributeName:"r",from:15,to:15,begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),s.createElement("animate",{attributeName:"fill-opacity",from:1,to:1,begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}))),r||(r=s.createElement("circle",{cx:60,cy:15,r:9,fillOpacity:.3,fill:"var(--primary, red)"},s.createElement("animate",{attributeName:"r",from:9,to:9,begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),s.createElement("animate",{attributeName:"fill-opacity",from:.5,to:.5,begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"}))),a||(a=s.createElement("circle",{cx:105,cy:15,r:15,fill:"var(--primary, red)"},s.createElement("animate",{attributeName:"r",from:15,to:15,begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),s.createElement("animate",{attributeName:"fill-opacity",from:1,to:1,begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"}))))}},3340:function(e,t,n){Promise.resolve().then(n.bind(n,7482))},9506:function(e){e.exports={"icon-button":"button_icon-button__BC_Ca",shadow:"button_shadow__Ap98F",border:"button_border__nGPHl","icon-button-icon":"button_icon-button-icon__qlUH3","icon-button-text":"button_icon-button-text__k3vob"}},1034:function(e){e.exports={"window-header":"home_window-header__248BE","window-header-title":"home_window-header-title__bJCkO","window-header-main-title":"home_window-header-main-title__Y16Es","window-header-sub-title":"home_window-header-sub-title__9rZM1","window-actions":"home_window-actions__k4f3s","window-action-button":"home_window-action-button__Is6GK",container:"home_container__Myqoy","tight-container":"home_tight-container__sz6zy",sidebar:"home_sidebar__4L4yT","window-content":"home_window-content__RRVow",mobile:"home_mobile__ako7k","sidebar-show":"home_sidebar-show__I77cg","sidebar-header":"home_sidebar-header__b5asC","sidebar-logo":"home_sidebar-logo__FFdBS","sidebar-title":"home_sidebar-title__d8_c_","sidebar-sub-title":"home_sidebar-sub-title__IS2Or","sidebar-body":"home_sidebar-body__zSPJN","chat-item":"home_chat-item__7LfQR","chat-item-selected":"home_chat-item-selected__6TyNm","chat-item-title":"home_chat-item-title__LZXA_","chat-item-delete":"home_chat-item-delete__xQ_8e","chat-item-info":"home_chat-item-info__UAzOv","sidebar-tail":"home_sidebar-tail__R8VX2","sidebar-actions":"home_sidebar-actions__zyNfR","sidebar-action":"home_sidebar-action__JhMu0",chat:"home_chat__7Bh_I","chat-body":"home_chat-body__mbaM8","chat-body-title":"home_chat-body-title__5S8w4","chat-message":"home_chat-message__rdH_g","chat-message-user":"home_chat-message-user__WsuiB","chat-message-container":"home_chat-message-container__plj_e","slide-in":"home_slide-in__gYZA0","chat-message-top-actions":"home_chat-message-top-actions__PfOzb","chat-message-avatar":"home_chat-message-avatar__611lI","chat-message-status":"home_chat-message-status__EsVNi","user-avtar":"home_user-avtar__3QksJ","chat-message-item":"home_chat-message-item__hDEOq","chat-message-top-action":"home_chat-message-top-action__wXKmA","chat-message-actions":"home_chat-message-actions__nrHd1","chat-message-action-date":"home_chat-message-action-date__6ToUp","chat-input-panel":"home_chat-input-panel__kmhBn","prompt-hints":"home_prompt-hints__Nv0JN","prompt-hint":"home_prompt-hint__7bycW","hint-title":"home_hint-title__V1gw6","hint-content":"home_hint-content__GHRmC","prompt-hint-selected":"home_prompt-hint-selected__LI_5l","chat-input-panel-inner":"home_chat-input-panel-inner__8J59p","chat-input":"home_chat-input__qM_hd","chat-input-send":"home_chat-input-send__rsJfH","export-content":"home_export-content__ZTj0v","loading-content":"home_loading-content__tru2c","slide-in-from-top":"home_slide-in-from-top__DysOS"}},9468:function(e){e.exports={card:"ui-lib_card__umMjN",popover:"ui-lib_popover__5cywD","popover-content":"ui-lib_popover-content__gZ0he","slide-in":"ui-lib_slide-in__iob7i","popover-mask":"ui-lib_popover-mask__iViG8","list-item":"ui-lib_list-item__MN4sf",list:"ui-lib_list__uHeWh","modal-container":"ui-lib_modal-container__Ra9HB","modal-header":"ui-lib_modal-header__S9ma8","modal-title":"ui-lib_modal-title__i_dpP","modal-close-btn":"ui-lib_modal-close-btn__mIjOX","modal-content":"ui-lib_modal-content__nFcGO","modal-footer":"ui-lib_modal-footer__J_cgq","modal-actions":"ui-lib_modal-actions__0VvYa","modal-action":"ui-lib_modal-action__12xLt",show:"ui-lib_show__3Gd4p",hide:"ui-lib_hide__GF1sp","toast-container":"ui-lib_toast-container__7epyd","toast-content":"ui-lib_toast-content__XpHSf","toast-action":"ui-lib_toast-action__wO4Lv",input:"ui-lib_input__v_cwR","slide-in-from-top":"ui-lib_slide-in-from-top__Qfsdu"}},2383:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var o=n(9268);n(6006);var r=n(9506),a=n.n(r);function s(e){var t;return(0,o.jsxs)("button",{className:a()["icon-button"]+" ".concat(e.bordered&&a().border," ").concat(e.shadow&&a().shadow," ").concat(null!==(t=e.className)&&void 0!==t?t:""," clickable"),onClick:e.onClick,title:e.title,disabled:e.disabled,role:"button",children:[(0,o.jsx)("div",{className:a()["icon-button-icon"]+" ".concat(e.noDark&&"no-dark"),children:e.icon}),e.text&&(0,o.jsx)("div",{className:a()["icon-button-text"],children:e.text})]})}},4409:function(e,t,n){"use strict";n.d(t,{qE:function(){return K},en:function(){return U}});var o,r,a,s,i,l,c,d,u,m,h=n(9268),p=n(9357),g=n(6006),f=n(6254);function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var _=function(e){return f.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),o||(o=f.createElement("defs",null,f.createElement("path",{id:"send-white_svg__a",d:"M0 0h16v16H0z"}))),f.createElement("g",null,r||(r=f.createElement("mask",{id:"send-white_svg__b",fill:"#fff"},f.createElement("use",{xlinkHref:"#send-white_svg__a"}))),f.createElement("g",{mask:"url(#send-white_svg__b)"},f.createElement("path",{style:{stroke:"#fff",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.333 2)",d:"M0 4.71 6.67 6l1.67 6.67L12.67 0 0 4.71Z"}),f.createElement("path",{style:{stroke:"#fff",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(8.003 6.117)",d:"M0 1.89 1.89 0"}))))};function y(){return(y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var b=function(e){return f.createElement("svg",y({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),a||(a=f.createElement("defs",null,f.createElement("path",{id:"export_svg__a",d:"M0 0h16v16H0z"}))),f.createElement("g",null,s||(s=f.createElement("mask",{id:"export_svg__b",fill:"#fff"},f.createElement("use",{xlinkHref:"#export_svg__a"}))),f.createElement("g",{mask:"url(#export_svg__b)"},f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.24 2.333)",d:"M12.27 9.11a3.09 3.09 0 0 0 1.16-3.44c-.41-1.28-1.65-1.98-2.99-1.98h-.77A4.924 4.924 0 0 0 5.47.03C3.45-.2 1.5.84.56 2.64c-.94 1.81-.67 4 .67 5.53"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(8 7.667)",d:"M0 6V0"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(5.879 11.545)",d:"M4.24 0 2.12 2.12 0 0"}))))};function w(){return(w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var k=function(e){return f.createElement("svg",w({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),i||(i=f.createElement("defs",null,f.createElement("path",{id:"return_svg__a",d:"M0 0h16v16H0z"}))),f.createElement("g",null,l||(l=f.createElement("mask",{id:"return_svg__b",fill:"#fff"},f.createElement("use",{xlinkHref:"#return_svg__a"}))),f.createElement("g",{mask:"url(#return_svg__b)"},f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2 2.667)",d:"M2.33 0 0 2l2.33 2.33"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2 4.667)",d:"M0 0h7.66c2.3 0 4.25 1.87 4.34 4.17.09 2.42-1.91 4.5-4.34 4.5H2"}))))};function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var x=function(e){return f.createElement("svg",C({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),c||(c=f.createElement("defs",null,f.createElement("path",{id:"copy_svg__a",d:"M0 0h16v16H0z"}))),f.createElement("g",null,d||(d=f.createElement("mask",{id:"copy_svg__b",fill:"#fff"},f.createElement("use",{xlinkHref:"#copy_svg__a"}))),f.createElement("g",{mask:"url(#copy_svg__b)"},f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(4.333 1.667)",d:"M0 2.48V.94C0 .42.42 0 .94 0h8.12c.52 0 .94.42.94.94v8.12c0 .52-.42.94-.94.94H7.51"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.667 4.333)",d:"M.94 0C.42 0 0 .42 0 .94v8.12c0 .52.42.94.94.94h8.12c.52 0 .94-.42.94-.94V.94C10 .42 9.58 0 9.06 0H.94Z"}))))};function E(){return(E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var S=function(e){return f.createElement("svg",E({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),u||(u=f.createElement("defs",null,f.createElement("path",{id:"download_svg__a",d:"M0 0h16v16H0z"}))),f.createElement("g",null,m||(m=f.createElement("mask",{id:"download_svg__b",fill:"#fff"},f.createElement("use",{xlinkHref:"#download_svg__a"}))),f.createElement("g",{mask:"url(#download_svg__b)"},f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2 2)",d:"M1 12h10c.55 0 1-.45 1-1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v10c0 .55.45 1 1 1Z"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.333 10.333)",d:"M0 0h3.67l.66 1.33H9L9.67 0h3.66"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(14 8.667)",d:"M0 3.33V0"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(6 7.333)",d:"m0 0 2 2 2-2"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(8 4)",d:"M0 5.33V0"}),f.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2 8.667)",d:"M0 3.33V0"}))))},T=n(359),j=n(8584),M=n(345),P=n(1777),A=n(4843),N=n.n(A),O=n(6602),I=n(9199),H=n(5917),D=n(2383),Z=n(1034),L=n.n(Z),R=n(3822);let B=N()(async()=>(0,g.memo)((await Promise.all([n.e(659),n.e(390),n.e(925)]).then(n.bind(n,6925))).Markdown),{loadableGenerated:{webpack:()=>[6925]},loading:()=>(0,h.jsx)(T.Z,{})}),z=N()(async()=>(await Promise.all([n.e(956),n.e(791)]).then(n.bind(n,3031))).Emoji,{loadableGenerated:{webpack:()=>[3031]},loading:()=>(0,h.jsx)(T.Z,{})});function K(e){let t=(0,M.aK)(e=>e.config);return"user"!==e.role?(0,h.jsx)(j.Z,{className:L()["user-avtar"]}):(0,h.jsx)("div",{className:L()["user-avtar"],children:(0,h.jsx)(z,{unified:t.avatar,size:18,getEmojiUrl:P.qc})})}function F(e){return 0===e.prompts.length?null:(0,h.jsx)("div",{className:L()["prompt-hints"],children:e.prompts.map((t,n)=>(0,h.jsxs)("div",{className:L()["prompt-hint"],onClick:()=>e.onPromptSelect(t),children:[(0,h.jsx)("div",{className:L()["hint-title"],children:t.title}),(0,h.jsx)("div",{className:L()["hint-content"],children:t.content})]},t.title+n.toString()))})}function U(e){var t;let n=(0,M.aK)(),[o,r]=(0,M.aK)(e=>[e.currentSession(),e.currentSessionIndex]),a=(0,M.aK)(e=>e.config.fontSize),s=(0,g.useRef)(null),[i,l]=(0,g.useState)(""),[c,d]=(0,g.useState)(""),[u,m]=(0,g.useState)(!1),{submitKey:f,shouldSubmit:v}=function(){let e=(0,M.aK)(e=>e.config),t=e.submitKey;return{submitKey:t,shouldSubmit:t=>"Enter"===t.key&&("Enter"!==t.key||!t.nativeEvent.isComposing)&&(e.submitKey===M.mQ.AltEnter&&t.altKey||e.submitKey===M.mQ.CtrlEnter&&t.ctrlKey||e.submitKey===M.mQ.ShiftEnter&&t.shiftKey||e.submitKey===M.mQ.MetaEnter&&t.metaKey||e.submitKey===M.mQ.Enter&&!t.altKey&&!t.ctrlKey&&!t.shiftKey&&!t.metaKey)}}(),{scrollRef:y,setAutoScroll:w}=function(){let e=(0,g.useRef)(null),[t,n]=(0,g.useState)(!0);return(0,g.useLayoutEffect)(()=>{let n=e.current;n&&t&&setTimeout(()=>n.scrollTop=n.scrollHeight,1)}),{scrollRef:e,autoScroll:t,setAutoScroll:n}}(),[C,E]=(0,g.useState)(!1),j=e=>{let t=e.scrollTop+e.clientHeight>=e.scrollHeight-20;E(t)},A=(0,I.f5)(),[N,Z]=(0,g.useState)([]),z=(0,p.y1)(e=>{Z(A.search(e))},100,{leading:!0,trailing:!0}),U=e=>{var t;l(e.content),Z([]),null===(t=s.current)||void 0===t||t.focus()},W=()=>{let e=s.current;if(!e)return;let t=parseInt(window.getComputedStyle(e).paddingBottom,10);e.scrollTop=e.scrollHeight-e.offsetHeight+t},[Q,V]=(0,g.useState)(2),G=(0,p.y1)(()=>{let e=s.current?(0,P.lx)(s.current):1,t=Math.min(5,Math.max(2+Number(!(0,P.Av)()),e));V(t)},100,{leading:!0,trailing:!0});(0,g.useEffect)(G,[i]);let X=e=>{W(),l(e);let t=e.trim().length;0===t?Z([]):!n.config.disablePromptHint&&t<30&&e.startsWith("/")&&z(e.slice(1))},q=()=>{var e;i.length<=0||(m(!0),n.onUserInput(i).then(()=>m(!1)),d(i),l(""),Z([]),(0,P.Av)()||null===(e=s.current)||void 0===e||e.focus(),w(!0))},Y=e=>{O.u4.stop(r,e)},J=e=>{if("ArrowUp"===e.key&&i.length<=0){l(c),e.preventDefault();return}v(e)&&(q(),e.preventDefault())},$=(e,t)=>{"user"===t.role&&l(t.content),(0,P.Ri)(e.currentTarget,t.content)&&e.preventDefault()},ee=e=>{for(let o=e;o>=0;o-=1)if("user"===eo[o].role){var t;m(!0),n.onUserInput(eo[o].content).then(()=>m(!1)),n.updateCurrentSession(e=>e.messages.splice(o,2)),null===(t=s.current)||void 0===t||t.focus();return}},et=(0,M.aK)(e=>e.config),en=o.context.slice();0===en.length&&(null===(t=o.messages.at(0))||void 0===t?void 0:t.content)!==M.ux.content&&en.push(M.ux);let eo=en.concat(o.messages).concat(u?[{...(0,M.tn)({role:"assistant",content:"……"}),preview:!0}]:[]).concat(i.length>0&&et.sendPreviewBubble?[{...(0,M.tn)({role:"user",content:i}),preview:!0}]:[]),[er,ea]=(0,g.useState)(!1);return(0,g.useEffect)(()=>{var t;e.sideBarShowing&&(0,P.Av)()||null===(t=s.current)||void 0===t||t.focus()},[]),(0,h.jsxs)("div",{className:L().chat,children:[(0,h.jsxs)("div",{className:L()["window-header"],children:[(0,h.jsxs)("div",{className:L()["window-header-title"],children:[(0,h.jsx)("div",{className:"".concat(L()["window-header-main-title"]," ").concat(L()["chat-body-title"]),onClickCapture:()=>{let e=prompt(H.ZP.Chat.Rename,o.topic);e&&e!==o.topic&&n.updateCurrentSession(t=>t.topic=e)},children:o.topic}),(0,h.jsx)("div",{className:L()["window-header-sub-title"],children:H.ZP.Chat.SubTitle(o.messages.length)})]}),(0,h.jsxs)("div",{className:L()["window-actions"],children:[(0,h.jsx)("div",{className:L()["window-action-button"]+" "+L().mobile,children:(0,h.jsx)(D.h,{icon:(0,h.jsx)(k,{}),bordered:!0,title:H.ZP.Chat.Actions.ChatList,onClick:null==e?void 0:e.showSideBar})}),(0,h.jsx)("div",{className:L()["window-action-button"],children:(0,h.jsx)(D.h,{icon:(0,h.jsx)(b,{}),bordered:!0,title:H.ZP.Chat.Actions.Export,onClick:()=>{!function(e,t){let n="# ".concat(t,"\n\n")+e.map(e=>"user"===e.role?"## ".concat(H.ZP.Export.MessageFromYou,":\n").concat(e.content):"## ".concat(H.ZP.Export.MessageFromChatBot,":\n").concat(e.content.trim())).join("\n\n"),o="".concat(t,".md");(0,R.K4)({title:H.ZP.Export.Title,children:(0,h.jsx)("div",{className:"markdown-body",children:(0,h.jsx)("pre",{className:L()["export-content"],children:n})}),actions:[(0,h.jsx)(D.h,{icon:(0,h.jsx)(x,{}),bordered:!0,text:H.ZP.Export.Copy,onClick:()=>(0,P.vQ)(n)},"copy"),(0,h.jsx)(D.h,{icon:(0,h.jsx)(S,{}),bordered:!0,text:H.ZP.Export.Download,onClick:()=>(0,P.CP)(n,o)},"download")]})}(o.messages.filter(e=>!e.isError),o.topic)}})})]})]}),(0,h.jsx)("div",{className:L()["chat-body"],ref:y,onScroll:e=>j(e.currentTarget),onWheel:e=>w(C&&e.deltaY>0),onTouchStart:()=>{var e;null===(e=s.current)||void 0===e||e.blur(),w(!1)},children:eo.map((e,t)=>{var n;let o="user"===e.role;return(0,h.jsx)("div",{className:o?L()["chat-message-user"]:L()["chat-message"],children:(0,h.jsxs)("div",{className:L()["chat-message-container"],children:[(0,h.jsx)("div",{className:L()["chat-message-avatar"],children:(0,h.jsx)(K,{role:e.role})}),(e.preview||e.streaming)&&(0,h.jsx)("div",{className:L()["chat-message-status"],children:H.ZP.Chat.Typing}),(0,h.jsxs)("div",{className:L()["chat-message-item"],children:[!o&&!(e.preview||0===e.content.length)&&(0,h.jsxs)("div",{className:L()["chat-message-top-actions"],children:[e.streaming?(0,h.jsx)("div",{className:L()["chat-message-top-action"],onClick:()=>Y(null!==(n=e.id)&&void 0!==n?n:t),children:H.ZP.Chat.Actions.Stop}):(0,h.jsx)("div",{className:L()["chat-message-top-action"],onClick:()=>ee(t),children:H.ZP.Chat.Actions.Retry}),(0,h.jsx)("div",{className:L()["chat-message-top-action"],onClick:()=>(0,P.vQ)(e.content),children:H.ZP.Chat.Actions.Copy})]}),(e.preview||0===e.content.length)&&!o?(0,h.jsx)(T.Z,{}):(0,h.jsx)("div",{className:"markdown-body",style:{fontSize:"".concat(a,"px")},onContextMenu:t=>$(t,e),onDoubleClickCapture:()=>{(0,P.Av)()&&l(e.content)},children:(0,h.jsx)(B,{content:e.content})})]}),!o&&!e.preview&&(0,h.jsx)("div",{className:L()["chat-message-actions"],children:(0,h.jsx)("div",{className:L()["chat-message-action-date"],children:e.date.toLocaleString()})})]})},t)})}),(0,h.jsxs)("div",{className:L()["chat-input-panel"],children:[(0,h.jsx)(F,{prompts:N,onPromptSelect:U}),(0,h.jsxs)("div",{className:L()["chat-input-panel-inner"],children:[(0,h.jsx)("textarea",{ref:s,className:L()["chat-input"],placeholder:H.ZP.Chat.Input(f),onInput:e=>X(e.currentTarget.value),value:i,onKeyDown:J,onFocus:()=>w(!0),onBlur:()=>{w(!1),setTimeout(()=>Z([]),500)},autoFocus:!(null==e?void 0:e.sideBarShowing),rows:Q}),(0,h.jsx)(D.h,{icon:(0,h.jsx)(_,{}),text:H.ZP.Chat.Send,className:L()["chat-input-send"],noDark:!0,onClick:q})]})]})]},o.id)}},2650:function(e,t,n){"use strict";n.d(t,{S:function(){return m}});var o,r,a=n(9268),s=n(6006),i=n(2383),l=n(6254);function c(){return(c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var d=function(e){return l.createElement("svg",c({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),o||(o=l.createElement("defs",null,l.createElement("path",{id:"github_svg__a",d:"M0 0h16v16H0z"}))),l.createElement("g",null,r||(r=l.createElement("mask",{id:"github_svg__b",fill:"#fff"},l.createElement("use",{xlinkHref:"#github_svg__a"}))),l.createElement("g",{mask:"url(#github_svg__b)"},l.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2.667 1.645)",d:"M7.11 8.51c.81-.16 1.53-.45 2.1-.87.96-.73 1.46-1.85 1.46-2.95 0-.78-.3-1.5-.81-2.11-.28-.34.55-2.89-.19-2.55-.73.34-1.81 1.1-2.38.94C6.68.79 6.02.69 5.33.69c-.6 0-1.17.07-1.71.21-.79.2-1.53-.54-2.29-.87C.58-.29.99 2.34.77 2.62.28 3.22 0 3.93 0 4.69c0 1.1.6 2.22 1.56 2.95.65.48 1.45.78 2.35.94"}),l.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(6 10.22)",d:"M.58 0C.19.43 0 .83 0 1.21v2.91"}),l.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(9.782 10.159)",d:"M0 0c.37.48.55.91.55 1.29v2.89"}),l.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(2 10.405)",d:"M0 0c.3.04.52.17.67.41C.88.77 1.69 2.1 2.61 2.1H4"}))))},u=n(4240);class m extends s.Component{componentDidCatch(e,t){this.setState({hasError:!0,error:e,info:t})}render(){if(this.state.hasError){var e,t;return(0,a.jsxs)("div",{className:"error",children:[(0,a.jsx)("h2",{children:"Oops, something went wrong!"}),(0,a.jsxs)("pre",{children:[(0,a.jsx)("code",{children:null===(e=this.state.error)||void 0===e?void 0:e.toString()}),(0,a.jsx)("code",{children:null===(t=this.state.info)||void 0===t?void 0:t.componentStack})]}),(0,a.jsx)("a",{href:u.TH,className:"report",children:(0,a.jsx)(i.h,{text:"Report This Error",icon:(0,a.jsx)(d,{}),bordered:!0})})]})}return this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null,info:null}}}},7482:function(e,t,n){"use strict";n.r(t),n.d(t,{Home:function(){return D},Loading:function(){return A}});var o,r,a,s,i,l,c=n(9268),d=n(6006),u=n(2383),m=n(1034),h=n.n(m),p=n(6254);function g(){return(g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var f=function(e){return p.createElement("svg",g({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),o||(o=p.createElement("defs",null,p.createElement("path",{id:"settings_svg__a",d:"M0 0h16v16H0z"}))),p.createElement("g",null,r||(r=p.createElement("mask",{id:"settings_svg__b",fill:"#fff"},p.createElement("use",{xlinkHref:"#settings_svg__a"}))),p.createElement("g",{mask:"url(#settings_svg__b)"},p.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.333 2.333)",d:"M13.33 5.67 10 0H3.33L0 5.67l3.33 5.66H10l3.33-5.66Z"}),p.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(6.333 6.333)",d:"M3.33 1.67C3.33.75 2.59 0 1.67 0 .75 0 0 .75 0 1.67c0 .92.75 1.66 1.67 1.66.92 0 1.66-.74 1.66-1.66Z"}))))};function v(){return(v=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var _=function(e){return p.createElement("svg",v({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:43,height:44,fill:"none"},e),a||(a=p.createElement("defs",null,p.createElement("path",{id:"aibot_svg__a",d:"M0 0h43v43.58H0z"}))),p.createElement("g",null,s||(s=p.createElement("mask",{id:"aibot_svg__b",fill:"#fff"},p.createElement("use",{xlinkHref:"#aibot_svg__a"}))),p.createElement("g",{mask:"url(#aibot_svg__b)"},p.createElement("path",{fillRule:"evenodd",style:{fill:"#8bcae0"},opacity:.27,d:"M40.17 17.84c.36-1.11.55-2.27.55-3.43 0-1.93-.51-3.83-1.49-5.49a10.98 10.98 0 0 0-9.52-5.51c-.77 0-1.55.08-2.3.24A10.868 10.868 0 0 0 19.29 0h-.1c-4.76 0-8.98 3.07-10.45 7.6-3.06.63-5.71 2.55-7.26 5.27a10.993 10.993 0 0 0 1.35 12.87c-.36 1.11-.55 2.27-.55 3.43 0 1.93.51 3.83 1.49 5.49a10.97 10.97 0 0 0 11.82 5.27c2.06 2.32 5.02 3.65 8.12 3.65h.1c4.76 0 8.99-3.07 10.45-7.61a10.82 10.82 0 0 0 7.26-5.26 10.995 10.995 0 0 0-1.35-12.87ZM18.817 38.695c-.09.05-.17.1-.26.15a8.145 8.145 0 0 0 5.22 1.89h.01c4.5-.01 8.15-3.67 8.16-8.17v-10.13a.153.153 0 0 0-.07-.1l-3.67-2.12v12.24c0 .51-.27.98-.72 1.23l-8.67 5.01Zm-1.424-2.472 8.77-5.06c.04-.03.06-.07.06-.11h-.01v-4.24l-10.59 6.12c-.44.25-.98.25-1.42 0l-8.68-5.01c-.08-.05-.2-.12-.26-.16a8.19 8.19 0 0 0 .97 5.47 8.18 8.18 0 0 0 7.08 4.08c1.43 0 2.84-.37 4.08-1.09Zm-9.187-25.21v-.3c-1.79.66-3.3 1.93-4.25 3.58a8.226 8.226 0 0 0-1.09 4.08c0 2.92 1.55 5.61 4.08 7.07l8.77 5.07c.04.02.09.02.12-.01l3.67-2.12-10.59-6.11c-.44-.25-.71-.72-.71-1.23v-10.03Zm27.849 7.117-8.77-5.07a.126.126 0 0 0-.12.01l-3.67 2.12 10.59 6.12c.44.25.71.71.71 1.22v10.33a8.168 8.168 0 0 0 5.35-7.66 8.16 8.16 0 0 0-4.09-7.07Zm-19.22-5.718a.16.16 0 0 0-.05.11v4.24l10.59-6.12c.22-.12.47-.19.72-.19s.49.07.71.19l8.68 5.02c.08.05.17.1.25.15.08-.46.12-.92.12-1.38 0-4.51-3.66-8.17-8.17-8.17-1.43 0-2.83.38-4.08 1.09l-8.77 5.06ZM19.22 2.85c-4.51 0-8.17 3.65-8.17 8.16v10.13c.01.05.03.08.07.1l3.67 2.12.01-12.23v-.01c0-.5.27-.97.71-1.22l8.68-5.01c.07-.05.19-.11.25-.15a8.145 8.145 0 0 0-5.22-1.89ZM16.783 24.51l4.72 2.73 4.72-2.73v-5.45l-4.72-2.72-4.72 2.73v5.44Z"}))))},y=n(8584);function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var w=function(e){return p.createElement("svg",b({xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:16,height:16,fill:"none"},e),i||(i=p.createElement("defs",null,p.createElement("path",{id:"add_svg__a",d:"M0 0h16v16H0z"}))),p.createElement("g",null,l||(l=p.createElement("mask",{id:"add_svg__b",fill:"#fff"},p.createElement("use",{xlinkHref:"#add_svg__a"}))),p.createElement("g",{mask:"url(#add_svg__b)"},p.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(1.333 1.333)",d:"M13.33 6.67A6.66 6.66 0 0 0 6.67 0C2.98 0 0 2.98 0 6.67a6.66 6.66 0 0 0 6.67 6.66c3.68 0 6.66-2.98 6.66-6.66Z"}),p.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(8 5.333)",d:"M0 0v5.33"}),p.createElement("path",{style:{stroke:"#333",strokeWidth:1.3333333333333333,strokeOpacity:1,strokeDasharray:"0 0"},transform:"translate(5.333 8)",d:"M0 0h5.33"}))))},k=n(359),C=n(5520),x=n(345),E=n(1777),S=n(5917),T=n(4409),j=n(4843),M=n.n(j),P=n(2650);function A(e){return(0,c.jsxs)("div",{className:h()["loading-content"],children:[!e.noLogo&&(0,c.jsx)(y.Z,{}),(0,c.jsx)(k.Z,{})]})}n(2508);let N=M()(async()=>(await Promise.all([n.e(956),n.e(317)]).then(n.bind(n,3862))).Settings,{loadableGenerated:{webpack:()=>[3862]},loading:()=>(0,c.jsx)(A,{noLogo:!0})}),O=M()(async()=>(await Promise.all([n.e(201),n.e(602),n.e(798)]).then(n.bind(n,3798))).ChatList,{loadableGenerated:{webpack:()=>[3798]},loading:()=>(0,c.jsx)(A,{noLogo:!0})}),I=()=>{let[e,t]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{t(!0)},[]),e};function H(){let[e,t,n]=(0,x.aK)(e=>[e.newSession,e.currentSessionIndex,e.removeSession]),o=(0,x.aK)(),r=!I(),[a,s]=(0,d.useState)(!0),[i,l]=(0,d.useState)(!1),m=(0,x.aK)(e=>e.config);return(!function(){let e=(0,x.aK)(e=>e.config);(0,d.useEffect)(()=>{document.body.classList.remove("light"),document.body.classList.remove("dark"),"dark"===e.theme?document.body.classList.add("dark"):"light"===e.theme&&document.body.classList.add("light");let t=document.querySelector('meta[name="theme-color"][media]'),n=document.querySelector('meta[name="theme-color"]:not([media])');if("auto"===e.theme)null==t||t.setAttribute("content","#151515"),null==n||n.setAttribute("content","#fafafa");else{let e=getComputedStyle(document.body).getPropertyValue("--theme-color").trim();null==t||t.setAttribute("content",e),null==n||n.setAttribute("content",e)}},[e.theme])}(),r)?(0,c.jsx)(A,{}):(0,c.jsxs)("div",{className:"".concat(m.tightBorder&&!(0,E.Av)()?h()["tight-container"]:h().container),children:[(0,c.jsxs)("div",{className:h().sidebar+" ".concat(a&&h()["sidebar-show"]),children:[(0,c.jsxs)("div",{className:h()["sidebar-header"],children:[(0,c.jsx)("div",{className:h()["sidebar-title"],children:"AI达人助手"}),(0,c.jsx)("div",{className:h()["sidebar-sub-title"],children:"请尽情享受与AI对话的乐趣"}),(0,c.jsx)("div",{className:h()["sidebar-logo"],children:(0,c.jsx)(_,{})})]}),(0,c.jsx)("div",{className:h()["sidebar-body"],onClick:()=>{l(!1),s(!1)},children:(0,c.jsx)(O,{})}),(0,c.jsxs)("div",{className:h()["sidebar-tail"],children:[(0,c.jsxs)("div",{className:h()["sidebar-actions"],children:[(0,c.jsx)("div",{className:h()["sidebar-action"]+" "+h().mobile,children:(0,c.jsx)(u.h,{icon:(0,c.jsx)(C.Z,{}),onClick:o.deleteSession})}),(0,c.jsx)("div",{className:h()["sidebar-action"],children:(0,c.jsx)(u.h,{icon:(0,c.jsx)(f,{}),onClick:()=>{l(!0),s(!1)},shadow:!0})})]}),(0,c.jsx)("div",{children:(0,c.jsx)(u.h,{icon:(0,c.jsx)(w,{}),text:S.ZP.Home.NewChat,onClick:()=>{e(),s(!1)},shadow:!0})})]})]}),(0,c.jsx)("div",{className:h()["window-content"],children:i?(0,c.jsx)(N,{closeSettings:()=>{l(!1),s(!0)}}):(0,c.jsx)(T.en,{showSideBar:()=>s(!0),sideBarShowing:a},"chat")})]})}function D(){return(0,c.jsx)(P.S,{children:(0,c.jsx)(H,{})})}},3822:function(e,t,n){"use strict";n.d(t,{CF:function(){return p},HC:function(){return c},J2:function(){return l},K4:function(){return m},aV:function(){return d}});var o=n(9268),r=n(9468),a=n.n(r);n(359);var s=n(5520),i=n(3194);function l(e){return(0,o.jsxs)("div",{className:a().popover,children:[e.children,e.open&&(0,o.jsxs)("div",{className:a()["popover-content"],children:[(0,o.jsx)("div",{className:a()["popover-mask"],onClick:e.onClose}),e.content]})]})}function c(e){if(e.children.length>2)throw Error("Only Support Two Children");return(0,o.jsx)("div",{className:a()["list-item"],children:e.children})}function d(e){return(0,o.jsx)("div",{className:a().list,children:e.children})}function u(e){var t;return(0,o.jsxs)("div",{className:a()["modal-container"],children:[(0,o.jsxs)("div",{className:a()["modal-header"],children:[(0,o.jsx)("div",{className:a()["modal-title"],children:e.title}),(0,o.jsx)("div",{className:a()["modal-close-btn"],onClick:e.onClose,children:(0,o.jsx)(s.Z,{})})]}),(0,o.jsx)("div",{className:a()["modal-content"],children:e.children}),(0,o.jsx)("div",{className:a()["modal-footer"],children:(0,o.jsx)("div",{className:a()["modal-actions"],children:null===(t=e.actions)||void 0===t?void 0:t.map((e,t)=>(0,o.jsx)("div",{className:a()["modal-action"],children:e},t))})})]})}function m(e){let t=document.createElement("div");t.className="modal-mask",document.body.appendChild(t);let n=(0,i.createRoot)(t),r=()=>{var o;null===(o=e.onClose)||void 0===o||o.call(e),n.unmount(),t.remove()};t.onclick=e=>{e.target===t&&r()},n.render((0,o.jsx)(u,{...e,onClose:r}))}function h(e){return(0,o.jsx)("div",{className:a()["toast-container"],children:(0,o.jsxs)("div",{className:a()["toast-content"],children:[(0,o.jsx)("span",{children:e.content}),e.action&&(0,o.jsx)("button",{onClick:e.action.onClick,className:a()["toast-action"],children:e.action.text})]})})}function p(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,r=document.createElement("div");r.className=a().show,document.body.appendChild(r);let s=(0,i.createRoot)(r),l=()=>{r.classList.add(a().hide),setTimeout(()=>{s.unmount(),r.remove()},300)};setTimeout(()=>{l()},n),s.render((0,o.jsx)(h,{content:e,action:t}))}n(6006)},4240:function(e,t,n){"use strict";n.d(t,{TE:function(){return s},TH:function(){return a}});let o="Yidadaa",r="ChatGPT-Next-Web";"https://github.com/".concat(o,"/").concat(r);let a="https://github.com/".concat(o,"/").concat(r,"/issues"),s="https://api.github.com/repos/".concat(o,"/").concat(r,"/commits?per_page=1");"https://api.github.com/repos/".concat(o,"/").concat(r,"/tags?per_page=1")},5917:function(e,t,n){"use strict";n.d(t,{DC:function(){return r},t4:function(){return i},ZP:function(){return l},VQ:function(){return s}});var o=n(2981);let r=["en","cn","tw"],a="lang";function s(){let e=function(e){try{return localStorage.getItem(e)}catch(e){return null}}(a);if(r.includes(null!=e?e:""))return e;let t=function(){try{return navigator.language.toLowerCase()}catch(e){return"cn"}}();return t.includes("zh")||t.includes("cn")?"cn":t.includes("tw")?"tw":"en"}function i(e){!function(e,t){try{localStorage.setItem(e,t)}catch(e){}}(a,e),location.reload()}var l={en:{WIP:"WIP...",Error:{Unauthorized:"Unauthorized access, please enter access code in settings page."},ChatItem:{ChatItemCount:e=>"".concat(e," messages")},Chat:{SubTitle:e=>"".concat(e," messages with AIBot"),Actions:{ChatList:"Go To Chat List",CompressedHistory:"Compressed History Memory Prompt",Export:"Export All Messages as Markdown",Copy:"Copy",Stop:"Stop",Retry:"Retry"},Rename:"Rename Chat",Typing:"Typing…",Input:e=>{var t="".concat(e," to send");return e===String(o.mQ.Enter)&&(t+=", Shift + Enter to wrap"),t+", / to search prompts"},Send:"Send"},Export:{Title:"All Messages",Copy:"Copy All",Download:"Download",MessageFromYou:"Message From You",MessageFromChatBot:"Message From AIBot"},Memory:{Title:"Memory Prompt",EmptyContent:"Nothing yet.",Send:"Send Memory",Copy:"Copy Memory",Reset:"Reset Session",ResetConfirm:"Resetting will clear the current conversation history and historical memory. Are you sure you want to reset?"},Home:{NewChat:"New Chat",DeleteChat:"Confirm to delete the selected conversation?",DeleteToast:"Chat Deleted",Revert:"Revert"},Settings:{Title:"Settings",SubTitle:"All Settings",Actions:{ClearAll:"Clear All Data",ResetAll:"Reset All Settings",Close:"Close",ConfirmResetAll:{Confirm:"Are you sure you want to reset all configurations?"},ConfirmClearAll:{Confirm:"Are you sure you want to reset all chat?"}},Lang:{Name:"Language",Options:{cn:"简体中文",en:"English",tw:"繁體中文",es:"Espa\xf1ol",it:"Italiano"}},Avatar:"Avatar",FontSize:{Title:"Font Size",SubTitle:"Adjust font size of chat content"},Update:{Version:e=>"Version: ".concat(e),IsLatest:"Latest version",CheckUpdate:"Check Update",IsChecking:"Checking update...",FoundUpdate:e=>"Found new version: ".concat(e),GoToUpdate:"Update"},SendKey:"Send Key",Theme:"Theme",TightBorder:"Tight Border",SendPreviewBubble:"Send Preview Bubble",Prompt:{Disable:{Title:"Disable auto-completion",SubTitle:"Input / to trigger auto-completion"},List:"Prompt List",ListCount:(e,t)=>"".concat(e," built-in, ").concat(t," user-defined"),Edit:"Edit"},HistoryCount:{Title:"Attached Messages Count",SubTitle:"Number of sent messages attached per request"},CompressThreshold:{Title:"History Compression Threshold",SubTitle:"Will compress if uncompressed messages length exceeds the value"},Token:{Title:"API Key",SubTitle:"Use your key to ignore access code limit",Placeholder:"OpenAI API Key"},Usage:{Title:"Account Balance",SubTitle:(e,t)=>"Used this month $".concat(e,", subscription $").concat(t),IsChecking:"Checking...",Check:"Check Again",NoAccess:"Enter API Key to check balance"},AccessCode:{Title:"Access Code",SubTitle:"Access control enabled",Placeholder:"Need Access Code"},Model:"Model",Temperature:{Title:"Temperature",SubTitle:"A larger value makes the more random output"},MaxTokens:{Title:"Max Tokens",SubTitle:"Maximum length of input tokens and generated tokens"},PresencePenlty:{Title:"Presence Penalty",SubTitle:"A larger value increases the likelihood to talk about new topics"}},Store:{DefaultTopic:"New Conversation",BotHello:"Hello! How can I assist you today?",Error:"Something went wrong, please try again later.",Prompt:{History:e=>"This is a summary of the chat history between the AI and the user as a recap: "+e,Topic:"Please generate a four to five word title summarizing our conversation without any lead-in, punctuation, quotation marks, periods, symbols, or additional text. Remove enclosing quotation marks.",Summarize:"Summarize our discussion briefly in 200 words or less to use as a prompt for future context."},ConfirmClearAll:"Confirm to clear all chat and setting data?"},Copy:{Success:"Copied to clipboard",Failed:"Copy failed, please grant permission to access clipboard"},Context:{Toast:e=>"With ".concat(e," contextual prompts"),Edit:"Contextual and Memory Prompts",Add:"Add One"}},cn:{WIP:"该功能仍在开发中……",Error:{Unauthorized:"现在是未授权状态，请在设置页输入访问密码。"},ChatItem:{ChatItemCount:e=>"".concat(e," 条对话")},Chat:{SubTitle:e=>"与 AI达人助手 的 ".concat(e," 条对话"),Actions:{ChatList:"查看消息列表",CompressedHistory:"查看压缩后的历史 Prompt",Export:"导出聊天记录",Copy:"复制",Stop:"停止",Retry:"重试"},Rename:"重命名对话",Typing:"正在输入…",Input:e=>{var t="".concat(e," 发送");return e===String(o.mQ.Enter)&&(t+="，Shift + Enter 换行"),t+"，/ 触发补全"},Send:"发送"},Export:{Title:"导出聊天记录为 Markdown",Copy:"全部复制",Download:"下载文件",MessageFromYou:"来自你的消息",MessageFromChatBot:"来自 AI达人助手 的消息"},Memory:{Title:"历史记忆",EmptyContent:"尚未记忆",Send:"发送记忆",Copy:"复制记忆",Reset:"重置对话",ResetConfirm:"重置后将清空当前对话记录以及历史记忆，确认重置？"},Home:{NewChat:"新的聊天",DeleteChat:"确认删除选中的对话？",DeleteToast:"已删除会话",Revert:"撤销"},Settings:{Title:"设置",SubTitle:"设置选项",Actions:{ClearAll:"清除所有数据",ResetAll:"重置所有选项",Close:"关闭",ConfirmResetAll:{Confirm:"确认重置全部配置吗？"},ConfirmClearAll:{Confirm:"确认清除全部聊天对话框？"}},Lang:{Name:"Language",Options:{cn:"简体中文",en:"English",tw:"繁體中文",es:"Espa\xf1ol",it:"Italiano"}},Avatar:"头像",FontSize:{Title:"字体大小",SubTitle:"聊天内容的字体大小"},Update:{Version:e=>"当前版本：".concat(e),IsLatest:"已是最新版本",CheckUpdate:"检查更新",IsChecking:"正在检查更新...",FoundUpdate:e=>"发现新版本：".concat(e),GoToUpdate:"前往更新"},SendKey:"发送键",Theme:"主题",TightBorder:"紧凑边框",SendPreviewBubble:"发送预览气泡",Prompt:{Disable:{Title:"禁用提示词自动补全",SubTitle:"在输入框开头输入 / 即可触发自动补全"},List:"自定义提示词列表",ListCount:(e,t)=>"内置 ".concat(e," 条，用户定义 ").concat(t," 条"),Edit:"编辑"},HistoryCount:{Title:"附带历史消息数",SubTitle:"每次请求携带的历史消息数"},CompressThreshold:{Title:"历史消息长度压缩阈值",SubTitle:"当未压缩的历史消息超过该值时，将进行压缩"},Token:{Title:"API Key",SubTitle:"使用自己的 Key 可绕过密码访问限制",Placeholder:"OpenAI API Key"},Usage:{Title:"余额查询",SubTitle:(e,t)=>"本月已使用 $".concat(e,"，订阅总额 $").concat(t),IsChecking:"正在检查…",Check:"重新检查",NoAccess:"输入 API Key 或访问密码查看余额"},AccessCode:{Title:"访问密码",SubTitle:"已开启加密访问",Placeholder:"请输入访问密码"},Model:"模型 (model)",Temperature:{Title:"随机性 (temperature)",SubTitle:"值越大，回复越随机，大于 1 的值可能会导致乱码"},MaxTokens:{Title:"单次回复限制 (max_tokens)",SubTitle:"单次交互所用的最大 Token 数"},PresencePenlty:{Title:"话题新鲜度 (presence_penalty)",SubTitle:"值越大，越有可能扩展到新话题"}},Store:{DefaultTopic:"新的聊天",BotHello:"有什么可以帮你的吗",Error:"出错了，稍后重试吧",Prompt:{History:e=>"这是 ai 和用户的历史聊天总结作为前情提要："+e,Topic:"使用四到五个字直接返回这句话的简要主题，不要解释、不要标点、不要语气词、不要多余文本，如果没有主题，请直接返回“闲聊”",Summarize:"简要总结一下你和用户的对话，用作后续的上下文提示 prompt，控制在 200 字以内"},ConfirmClearAll:"确认清除所有聊天、设置数据？"},Copy:{Success:"已写入剪切板",Failed:"复制失败，请赋予剪切板权限"},Context:{Toast:e=>"已设置 ".concat(e," 条前置上下文"),Edit:"前置上下文和历史记忆",Add:"新增一条"}},tw:{WIP:"該功能仍在開發中……",Error:{Unauthorized:"目前您的狀態是未授權，請前往設定頁面輸入授權碼。"},ChatItem:{ChatItemCount:e=>"".concat(e," 條對話")},Chat:{SubTitle:e=>"您已經與 AI达人助手 進行了 ".concat(e," 條對話"),Actions:{ChatList:"查看消息列表",CompressedHistory:"查看壓縮後的歷史 Prompt",Export:"匯出聊天紀錄",Copy:"複製",Stop:"停止",Retry:"重試"},Rename:"重命名對話",Typing:"正在輸入…",Input:e=>{var t="輸入訊息後，按下 ".concat(e," 鍵即可發送");return e===String(o.mQ.Enter)&&(t+="，Shift + Enter 鍵換行"),t},Send:"發送"},Export:{Title:"匯出聊天記錄為 Markdown",Copy:"複製全部",Download:"下載檔案",MessageFromYou:"來自你的訊息",MessageFromChatBot:"來自 AI达人助手 的訊息"},Memory:{Title:"上下文記憶 Prompt",EmptyContent:"尚未記憶",Copy:"複製全部",Send:"發送記憶",Reset:"重置對話",ResetConfirm:"重置後將清空當前對話記錄以及歷史記憶，確認重置？"},Home:{NewChat:"新的對話",DeleteChat:"確定要刪除選取的對話嗎？",DeleteToast:"已刪除對話",Revert:"撤銷"},Settings:{Title:"設定",SubTitle:"設定選項",Actions:{ClearAll:"清除所有數據",ResetAll:"重置所有設定",Close:"關閉",ConfirmResetAll:{Confirm:"Are you sure you want to reset all configurations?"},ConfirmClearAll:{Confirm:"Are you sure you want to reset all chat?"}},Lang:{Name:"Language",Options:{cn:"简体中文",en:"English",tw:"繁體中文",es:"Espa\xf1ol",it:"Italiano"}},Avatar:"大頭貼",FontSize:{Title:"字型大小",SubTitle:"聊天內容的字型大小"},Update:{Version:e=>"當前版本：".concat(e),IsLatest:"已是最新版本",CheckUpdate:"檢查更新",IsChecking:"正在檢查更新...",FoundUpdate:e=>"發現新版本：".concat(e),GoToUpdate:"前往更新"},SendKey:"發送鍵",Theme:"主題",TightBorder:"緊湊邊框",SendPreviewBubble:"發送預覽氣泡",Prompt:{Disable:{Title:"停用提示詞自動補全",SubTitle:"在輸入框開頭輸入 / 即可觸發自動補全"},List:"自定義提示詞列表",ListCount:(e,t)=>"內置 ".concat(e," 條，用戶定義 ").concat(t," 條"),Edit:"編輯"},HistoryCount:{Title:"附帶歷史訊息數",SubTitle:"每次請求附帶的歷史訊息數"},CompressThreshold:{Title:"歷史訊息長度壓縮閾值",SubTitle:"當未壓縮的歷史訊息超過該值時，將進行壓縮"},Token:{Title:"API Key",SubTitle:"使用自己的 Key 可規避授權訪問限制",Placeholder:"OpenAI API Key"},Usage:{Title:"帳戶餘額",SubTitle:(e,t)=>"本月已使用 $".concat(e,"，订阅总额 $").concat(t),IsChecking:"正在檢查…",Check:"重新檢查",NoAccess:"輸入API Key查看餘額"},AccessCode:{Title:"授權碼",SubTitle:"現在是未授權訪問狀態",Placeholder:"請輸入授權碼"},Model:"模型 (model)",Temperature:{Title:"隨機性 (temperature)",SubTitle:"值越大，回復越隨機"},MaxTokens:{Title:"單次回復限制 (max_tokens)",SubTitle:"單次交互所用的最大 Token 數"},PresencePenlty:{Title:"話題新穎度 (presence_penalty)",SubTitle:"值越大，越有可能擴展到新話題"}},Store:{DefaultTopic:"新的對話",BotHello:"請問需要我的協助嗎？",Error:"出錯了，請稍後再嘗試",Prompt:{History:e=>"這是 AI 與用戶的歷史聊天總結，作為前情提要："+e,Topic:"直接返回這句話的簡要主題，無須解釋，若無主題，請直接返回「閒聊」",Summarize:"簡要總結一下你和用戶的對話，作為後續的上下文提示 prompt，且字數控制在 200 字以內"},ConfirmClearAll:"確認清除所有對話、設定數據？"},Copy:{Success:"已複製到剪貼簿中",Failed:"複製失敗，請賦予剪貼簿權限"},Context:{Toast:e=>"已設置 ".concat(e," 條前置上下文"),Edit:"前置上下文和歷史記憶",Add:"新增壹條"}}}[s()]},2508:function(e,t,n){"use strict";n.r(t),Array.prototype.at||(Array.prototype.at=function(e){let t=this.length;if(e<0&&(e=t+e),!(e<0)&&!(e>=t))return Array.prototype.slice.call(this,e,e+1)[0]})},6602:function(e,t,n){"use strict";n.d(t,{b6:function(){return c},qd:function(){return u},u4:function(){return m},yY:function(){return d}});var o=n(345),r=n(3822);let a=(e,t)=>{let n=e.map(e=>({role:e.role,content:e.content}));(null==t?void 0:t.filterBot)&&(n=n.filter(e=>"assistant"!==e.role));let r={...o.aK.getState().config.modelConfig};return delete r.max_tokens,{messages:n,stream:null==t?void 0:t.stream,...r}};function s(){let e=o._X.getState(),t={};return e.enabledAccessControl()&&(t["access-code"]=e.accessCode),e.token&&e.token.length>0&&(t.token=e.token),t}function i(e){return function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST";return fetch("/api/openai?_vercel_no_cache=1",{method:n,headers:{"Content-Type":"application/json",path:e,...s()},body:t&&JSON.stringify(t)})}}async function l(e){let t=a(e,{filterBot:!0}),n=await i("v1/chat/completions")(t);try{let e=await n.json();return e}catch(e){console.error("[Request Chat] ",e,n.body)}}async function c(){let e=e=>"".concat(e.getFullYear(),"-").concat((e.getMonth()+1).toString().padStart(2,"0"),"-").concat(e.getDate().toString().padStart(2,"0")),t=new Date(Date.now()+1728e5),n=new Date(t.getFullYear(),t.getMonth(),1),o=e(n),a=e(t),[s,l]=await Promise.all([i("dashboard/billing/usage?start_date=".concat(o,"&end_date=").concat(a))(null,"GET"),i("dashboard/billing/subscription")(null,"GET")]),c=await s.json(),d=await l.json();if(c.error&&c.error.type){(0,r.CF)(c.error.message);return}return c.total_usage&&(c.total_usage=Math.round(c.total_usage)/100),{used:c.total_usage,subscription:d.hard_limit_usd}}async function d(e,t){let n=a(e,{stream:!0,filterBot:null==t?void 0:t.filterBot});console.log("[Request] ",n);let o=new AbortController,r=setTimeout(()=>o.abort(),3e4);try{let e=await fetch("/api/chat-stream",{method:"POST",headers:{"Content-Type":"application/json",path:"v1/chat/completions",...s()},body:JSON.stringify(n),signal:o.signal});clearTimeout(r);let a="",c=()=>{null==t||t.onMessage(a,!0),o.abort()};if(e.ok){var i,l;let n=null===(i=e.body)||void 0===i?void 0:i.getReader(),r=new TextDecoder;for(null==t||null===(l=t.onController)||void 0===l||l.call(t,o);;){let e=setTimeout(()=>c(),3e4),o=await (null==n?void 0:n.read());clearTimeout(e);let s=r.decode(null==o?void 0:o.value);a+=s;let i=!o||o.done;if(null==t||t.onMessage(a,!1),i)break}c()}else 401===e.status?(console.error("Anauthorized"),null==t||t.onError(Error("Anauthorized"),e.status)):(console.error("Stream Error",e.body),null==t||t.onError(Error("Stream Error"),e.status))}catch(e){console.error("NetWork Error",e),null==t||t.onError(e)}}async function u(e,t){var n,o,r,a;e=e.concat([{role:"user",content:t,date:new Date().toLocaleString()}]);let s=await l(e);return null!==(a=null===(n=null==s?void 0:null===(o=s.choices)||void 0===o?void 0:o.at(0))||void 0===n?void 0:null===(r=n.message)||void 0===r?void 0:r.content)&&void 0!==a?a:""}let m={controllers:{},addController(e,t,n){let o=this.key(e,t);return this.controllers[o]=n,o},stop(e,t){let n=this.key(e,t),o=this.controllers[n];null==o||o.abort()},remove(e,t){let n=this.key(e,t);delete this.controllers[n]},key:(e,t)=>"".concat(e,",").concat(t)}},2981:function(e,t,n){"use strict";n.d(t,{Q2:function(){return s},aK:function(){return y},mQ:function(){return a},tn:function(){return h},ux:function(){return f}});var o,r,a,s,i=n(2561),l=n(4475),c=n(6602),d=n(1777),u=n(5917),m=n(3822);function h(e){return{id:Date.now(),date:new Date().toLocaleString(),role:"user",content:"",...e}}(o=a||(a={})).Enter="Enter",o.CtrlEnter="Ctrl + Enter",o.ShiftEnter="Shift + Enter",o.AltEnter="Alt + Enter",o.MetaEnter="Meta + Enter",(r=s||(s={})).Auto="auto",r.Dark="dark",r.Light="light";let p={historyMessageCount:4,compressMessageLengthThreshold:1e3,sendBotMessages:!0,submitKey:a.CtrlEnter,avatar:"1f603",fontSize:14,theme:s.Light,tightBorder:!0,sendPreviewBubble:!0,disablePromptHint:!1,modelConfig:{model:"gpt-3.5-turbo",temperature:1,max_tokens:2e3,presence_penalty:0}},g=u.ZP.Store.DefaultTopic,f=h({role:"assistant",content:u.ZP.Store.BotHello});function v(){let e=new Date().toLocaleString();return{id:Date.now(),topic:g,sendMemory:!0,memoryPrompt:"",context:[],messages:[],stat:{tokenCount:0,wordCount:0,charCount:0},lastUpdate:e,lastSummarizeIndex:0}}function _(e){return e.reduce((e,t)=>e+t.content.length,0)}let y=(0,i.Ue)()((0,l.tJ)((e,t)=>({sessions:[v()],currentSessionIndex:0,config:{...p},clearSessions(){e(()=>({sessions:[v()],currentSessionIndex:0}))},resetConfig(){e(()=>({config:{...p}}))},getConfig:()=>t().config,updateConfig(n){let o=t().config;n(o),e(()=>({config:o}))},selectSession(t){e({currentSessionIndex:t})},removeSession(t){e(e=>{let n=e.currentSessionIndex,o=e.sessions;return 1===o.length?{currentSessionIndex:0,sessions:[v()]}:(o.splice(t,1),n===t&&(n-=1),{currentSessionIndex:n,sessions:o})})},moveSession(t,n){e(e=>{let{sessions:o,currentSessionIndex:r}=e,a=[...o],s=a[t];a.splice(t,1),a.splice(n,0,s);let i=r===t?n:r;return r>t&&r<=n?i-=1:r<t&&r>=n&&(i+=1),{currentSessionIndex:i,sessions:a}})},newSession(){e(e=>({currentSessionIndex:0,sessions:[v()].concat(e.sessions)}))},deleteSession(){let n=t().currentSession(),o=t().currentSessionIndex,r=1===t().sessions.length;confirm(u.ZP.Home.DeleteChat)&&(t().removeSession(o),(0,m.CF)(u.ZP.Home.DeleteToast,{text:u.ZP.Home.Revert,onClick(){e(e=>({sessions:e.sessions.slice(0,o).concat([n]).concat(e.sessions.slice(o+Number(r)))}))}}))},currentSession(){let n=t().currentSessionIndex,o=t().sessions;(n<0||n>=o.length)&&(n=Math.min(o.length-1,Math.max(0,n)),e(()=>({currentSessionIndex:n})));let r=o[n];return r},onNewMessage(e){t().updateCurrentSession(e=>{e.lastUpdate=new Date().toLocaleString()}),t().updateStat(e),t().summarizeSession()},async onUserInput(n){let o=h({role:"user",content:n}),r=h({role:"assistant",streaming:!0}),a=t().getMessagesWithMemory(),s=a.concat(o),i=t().currentSessionIndex,l=t().currentSession().messages.length+1;t().updateCurrentSession(e=>{e.messages.push(o),e.messages.push(r)}),console.log("[User Input] ",s),(0,c.yY)(s,{onMessage(n,o){if(o){var a;r.streaming=!1,r.content=n,t().onNewMessage(r),c.u4.remove(i,null!==(a=r.id)&&void 0!==a?a:l)}else r.content=n,e(()=>({}))},onError(t,n){var a;401===n?r.content=u.ZP.Error.Unauthorized:r.content+="\n\n"+u.ZP.Store.Error,r.streaming=!1,o.isError=!0,r.isError=!0,e(()=>({})),c.u4.remove(i,null!==(a=r.id)&&void 0!==a?a:l)},onController(e){var t;c.u4.addController(i,null!==(t=r.id)&&void 0!==t?t:l,e)},filterBot:!t().config.sendBotMessages,modelConfig:t().config.modelConfig})},getMemoryPrompt(){let e=t().currentSession();return{role:"system",content:u.ZP.Store.Prompt.History(e.memoryPrompt),date:""}},getMessagesWithMemory(){let e=t().currentSession(),n=t().config,o=e.messages.filter(e=>!e.isError),r=o.length,a=e.context.slice();if(e.sendMemory&&e.memoryPrompt&&e.memoryPrompt.length>0){let e=t().getMemoryPrompt();a.push(e)}let s=a.concat(o.slice(Math.max(0,r-n.historyMessageCount)));return s},updateMessage(n,o,r){let a=t().sessions,s=a.at(n),i=null==s?void 0:s.messages;r(null==i?void 0:i.at(o)),e(()=>({sessions:a}))},resetSession(){t().updateCurrentSession(e=>{e.messages=[],e.memoryPrompt=""})},summarizeSession(){var e,n,o;let r=t().currentSession();r.topic===g&&_(r.messages)>=50&&(0,c.qd)(r.messages,u.ZP.Store.Prompt.Topic).then(e=>{t().updateCurrentSession(t=>t.topic=e?(0,d.ez)(e):g)});let a=t().config,s=r.messages.slice(r.lastSummarizeIndex),i=_(s);if(i>(null===(e=t().config)||void 0===e?void 0:null===(n=e.modelConfig)||void 0===n?void 0:n.max_tokens)){let e=s.length;s=s.slice(Math.max(0,e-a.historyMessageCount))}s.unshift(t().getMemoryPrompt());let l=r.messages.length;console.log("[Chat History] ",s,i,a.compressMessageLengthThreshold),i>a.compressMessageLengthThreshold&&(0,c.yY)(s.concat({role:"system",content:u.ZP.Store.Prompt.Summarize,date:""}),{filterBot:!1,onMessage(e,t){r.memoryPrompt=e,t&&(console.log("[Memory] ",r.memoryPrompt),r.lastSummarizeIndex=l)},onError(e){console.error("[Summarize] ",e)}})},updateStat(e){t().updateCurrentSession(t=>{t.stat.charCount+=e.content.length})},updateCurrentSession(n){let o=t().sessions,r=t().currentSessionIndex;n(o[r]),e(()=>({sessions:o}))},clearAllData(){confirm(u.ZP.Store.ConfirmClearAll)&&(localStorage.clear(),location.reload())}}),{name:"chat-next-web-store",version:1.2,migrate:(e,t)=>(1===t&&e.sessions.forEach(e=>e.context=[]),t<1.2&&e.sessions.forEach(e=>e.sendMemory=!0),e)}))},345:function(e,t,n){"use strict";n.d(t,{ux:function(){return o.ux},mQ:function(){return o.mQ},Q2:function(){return o.Q2},tn:function(){return o.tn},_X:function(){return c},aK:function(){return o.aK},u2:function(){return l}});var o=n(2981),r=n(2561),a=n(4475),s=n(4240),i=n(1777);let l=(0,r.Ue)()((0,a.tJ)((e,t)=>({lastUpdate:0,remoteId:"",async getLatestCommitId(){let n=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=Date.now()-t().lastUpdate>6e5;if(!(n||o))return(0,i.w1)();try{let t=await (await fetch(s.TE)).json(),n=t[0].sha.substring(0,7);return e(()=>({lastUpdate:Date.now(),remoteId:n})),console.log("[Got Upstream] ",n),n}catch(e){return console.error("[Fetch Upstream Commit Id]",e),(0,i.w1)()}}}),{name:"chat-update",version:1})),c=(0,r.Ue)()((0,a.tJ)((e,t)=>({token:"",accessCode:"",enabledAccessControl:()=>"enabled"===(0,i.ep)("access"),updateCode(t){e(e=>({accessCode:t}))},updateToken(t){e(e=>({token:t}))}}),{name:"access-control",version:1}))},9199:function(e,t,n){"use strict";n.d(t,{f5:function(){return l},oD:function(){return i}});var o=n(2561),r=n(4475),a=n(184),s=n(5917);let i={ready:!1,engine:new a.Z([],{keys:["title"]}),count:{builtin:0},allBuiltInPrompts:[],init(e){this.ready||(this.allBuiltInPrompts=e,this.engine.setCollection(e),this.ready=!0)},remove(e){this.engine.remove(t=>t.id===e)},add(e){this.engine.add(e)},search(e){let t=this.engine.search(e);return t.map(e=>e.item)}},l=(0,o.Ue)()((0,r.tJ)((e,t)=>({latestId:0,prompts:new Map,add(n){let o=t().prompts;return n.id=t().latestId+1,o.set(n.id,n),e(()=>({latestId:n.id,prompts:o})),n.id},remove(n){let o=t().prompts;o.delete(n),i.remove(n),e(()=>({prompts:o}))},search(e){if(0===e.length){var n,o,r;let e=null!==(r=null===(n=t().prompts)||void 0===n?void 0:null===(o=n.values)||void 0===o?void 0:o.call(n))&&void 0!==r?r:[];return i.allBuiltInPrompts.concat([...e])}return i.search(e)}}),{name:"prompt-store",version:1,onRehydrateStorage(e){fetch("./prompts.json").then(e=>e.json()).then(t=>{var n,o;let r=[t.en,t.cn];"cn"===(0,s.VQ)()&&(r=r.reverse());let a=r.map(e=>e.map(e=>{let[t,n]=e;return{title:t,content:n}})).concat([...null!==(o=null==e?void 0:null===(n=e.prompts)||void 0===n?void 0:n.values())&&void 0!==o?o:[]]),l=a.reduce((e,t)=>e.concat(t),[]);i.count.builtin=t.en.length+t.cn.length,i.init(l)})}}))},1777:function(e,t,n){"use strict";let o;n.d(t,{Av:function(){return c},CP:function(){return l},Ri:function(){return d},ep:function(){return u},ez:function(){return s},lx:function(){return g},qc:function(){return h},vQ:function(){return i},w1:function(){return m}});var r=n(3822),a=n(5917);function s(e){return e.replace(/[，。！？”“"、,.!?]*$/,"")}async function i(e){try{await navigator.clipboard.writeText(e),(0,r.CF)(a.ZP.Copy.Success)}catch(n){let t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.focus(),t.select();try{document.execCommand("copy"),(0,r.CF)(a.ZP.Copy.Success)}catch(e){(0,r.CF)(a.ZP.Copy.Failed)}document.body.removeChild(t)}}function l(e,t){let n=document.createElement("a");n.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}function c(){return window.innerWidth<=600}function d(e,t){let n=window.getSelection();return(null==n?void 0:n.type)!=="Range"&&(i(t),!0)}function u(e,t){let n;if(document){var o;let t=document.head.querySelector("meta[name='".concat(e,"']"));n=null!==(o=null==t?void 0:t.content)&&void 0!==o?o:""}else n=null!=t?t:"";return n}function m(){return o||(o=u("version"))}function h(e,t){return"https://cdn.staticfile.org/emoji-datasource-apple/14.0.0/img/".concat(t,"/64/").concat(e,".png")}function p(e,t){let n=document.getElementById(e);return n||((n=document.createElement("span")).style.position="absolute",n.style.wordBreak="break-word",n.style.fontSize="14px",n.style.transform="translateY(-200vh)",n.style.pointerEvents="none",n.style.opacity="0",n.id=e,document.body.appendChild(n),null==t||t(n)),n}function g(e){let t=p("__measure"),n=p("__single_measure",e=>{e.innerText="TEXT_FOR_MEASURE"}),o=function(e){let t=window.getComputedStyle(e),n=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight),o=e.clientWidth-n;return o}(e);t.style.width=o+"px",t.innerHTML=e.value.trim().length>0?e.value:"1";let r=Math.max(0,e.value.split("\n").length-1),a=parseFloat(window.getComputedStyle(t).height),s=parseFloat(window.getComputedStyle(n).height);return Math.round(a/s)+r}}},function(e){e.O(0,[774,80,455,744],function(){return e(e.s=3340)}),_N_E=e.O()}]);